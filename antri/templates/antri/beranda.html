{% extends 'antri/base.html' %}
{% load static %}

{% block style %}
<link rel="stylesheet" type="text/css" href="{% static 'antri/css/beranda.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'antri/css/name-card.css' %}">
{% endblock %}

{% block content %}
{% include 'antri/name-card.html' %}
<div class="card">
  <h3>{{ date }}</h3>
  <table id="antri"></table>
  <a class="button" href="{% url 'antri:daftar-antri' %}">+ Daftar Antri Hari Lain</a>
</div>
{% endblock %}

{% block script %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
function antri() {
  $.ajax({
    url: '{% url 'antri:get-antri' %}',
    method: 'GET',
    data: {},
    success: function(result) {
      console.log(result)
      var table = document.getElementById('antri')
      var tbody = document.createElement('tbody')
      table.appendChild(tbody)

      var tr = document.createElement('tr')
      tbody.appendChild(tr)
      for (var head of result.table_head) {
          var th = document.createElement('th')
          th.className = head.toLowerCase().replace(' ', '-').replace('.', '')
          th.appendChild(document.createTextNode(head))
          tr.appendChild(th)
      }

      for (var x = 0; x < result.data.length; x++) {
        var tr = document.createElement('tr')
        tbody.appendChild(tr)

        for (y in result.data[x]) {
          var td = document.createElement('td')
          td.appendChild(document.createTextNode(result.data[x][y]))
          tr.appendChild(td)
        }
      }
    },
    error: function(a, b) {
      console.log(a)
      console.log(b)
    }
  })
}

antri()
</script>
{% endblock %}
